<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Disease modeling – R4PDE.net</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./prediction-warning-systems.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5T7SZYQV79"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5T7SZYQV79', { 'anonymize_ip': true});
</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction-warning-systems.html">Disease prediction</a></li><li class="breadcrumb-item"><a href="./prediction-disease-modeling.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R4PDE.net</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/emdelponte/epidemiology-R" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to cite</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the author</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Epidemic data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-terminology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Disease variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ordinal scales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-actual-severity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Measuring foliar severity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reliability and accuracy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sads.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Standard area diagrams</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Training sessions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-remote-sensing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Remote sensing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Temporal analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-dpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Disease progress curves</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Population models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./temporal-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model fitting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Spatial analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-gradients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Spatial gradients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Gradient models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fitting gradient models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Spatial patterns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Tests for patterns</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Epidemics and yield</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yieldloss-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Definitions and concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./yieldloss-regression-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistical models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Disease prediction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-warning-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction-disease-modeling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">20.1</span> Introduction</a></li>
  <li><a href="#controlled-environment" id="toc-controlled-environment" class="nav-link" data-scroll-target="#controlled-environment"><span class="header-section-number">20.2</span> Controlled environment</a>
  <ul>
  <li><a href="#infection-based-models" id="toc-infection-based-models" class="nav-link" data-scroll-target="#infection-based-models"><span class="header-section-number">20.2.1</span> Infection-based models</a>
  <ul>
  <li><a href="#temperature-effects" id="toc-temperature-effects" class="nav-link" data-scroll-target="#temperature-effects"><span class="header-section-number">20.2.1.1</span> Temperature effects</a>
  <ul class="collapse">
  <li><a href="#generalized-beta-function" id="toc-generalized-beta-function" class="nav-link" data-scroll-target="#generalized-beta-function"><span class="header-section-number">20.2.1.1.1</span> Generalized beta-function</a></li>
  <li><a href="#analytis-beta-function" id="toc-analytis-beta-function" class="nav-link" data-scroll-target="#analytis-beta-function"><span class="header-section-number">20.2.1.1.2</span> Analytis beta function</a></li>
  </ul></li>
  <li><a href="#moisture-effects" id="toc-moisture-effects" class="nav-link" data-scroll-target="#moisture-effects"><span class="header-section-number">20.2.1.2</span> Moisture effects</a>
  <ul class="collapse">
  <li><a href="#monomolecular-function" id="toc-monomolecular-function" class="nav-link" data-scroll-target="#monomolecular-function"><span class="header-section-number">20.2.1.2.1</span> Monomolecular function</a></li>
  <li><a href="#weibull-function" id="toc-weibull-function" class="nav-link" data-scroll-target="#weibull-function"><span class="header-section-number">20.2.1.2.2</span> Weibull function</a></li>
  </ul></li>
  <li><a href="#integrating-temperature-and-wetness-effects" id="toc-integrating-temperature-and-wetness-effects" class="nav-link" data-scroll-target="#integrating-temperature-and-wetness-effects"><span class="header-section-number">20.2.1.3</span> Integrating temperature and wetness effects</a></li>
  <li><a href="#magareys-generic-infection-model" id="toc-magareys-generic-infection-model" class="nav-link" data-scroll-target="#magareys-generic-infection-model"><span class="header-section-number">20.2.1.4</span> Magarey’s generic infection model</a></li>
  </ul></li>
  <li><a href="#latency-period-models" id="toc-latency-period-models" class="nav-link" data-scroll-target="#latency-period-models"><span class="header-section-number">20.2.2</span> Latency period models</a>
  <ul>
  <li><a href="#parabolic-function" id="toc-parabolic-function" class="nav-link" data-scroll-target="#parabolic-function"><span class="header-section-number">20.2.2.1</span> Parabolic function</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#field-data" id="toc-field-data" class="nav-link" data-scroll-target="#field-data"><span class="header-section-number">20.3</span> Field data</a>
  <ul>
  <li><a href="#variable-construction" id="toc-variable-construction" class="nav-link" data-scroll-target="#variable-construction"><span class="header-section-number">20.3.1</span> Variable construction</a>
  <ul>
  <li><a href="#window-pane" id="toc-window-pane" class="nav-link" data-scroll-target="#window-pane"><span class="header-section-number">20.3.1.1</span> Window-pane</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/emdelponte/epidemiology-R/edit/main/prediction-disease-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/emdelponte/epidemiology-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction-warning-systems.html">Disease prediction</a></li><li class="breadcrumb-item"><a href="./prediction-disease-modeling.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Disease modeling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">20.1</span> Introduction</h2>
<p>As seen in the previous chapter, plant disease modeling is a crucial tool for predicting disease dynamics and informing management decisions when integrated into decision support systems. By leveraging models, researchers and practitioners can anticipate disease outbreaks, assess potential risks, and implement timely interventions to mitigate losses <span class="citation" data-cites="savary2018 rossi2010a">(<a href="references.html#ref-rossi2010a" role="doc-biblioref">Rossi et al. 2010</a>; <a href="references.html#ref-savary2018" role="doc-biblioref">Savary et al. 2018</a>)</span>.</p>
<p>Mathematical modeling involves representing empirical phenomena and experimental outcomes using mathematical functions. The data used for these models may be collected specifically for modeling purposes or drawn from existing experiments and observations originally conducted to address different research questions, with such data often found in the literature <span class="citation" data-cites="hau1990">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>)</span>.</p>
<p>Mathematical models integrating plant, disease, and environmental - in most cases weather-based variables - factors have been developed since the mid-1900s (See recent review by <span class="citation" data-cites="gonzález-domínguez2023">González-Domínguez et al. (<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">2023</a>)</span> ). Dynamic modeling of disease epidemics gained traction in the early 1960s with foundational work by Vanderplank and Zadoks, setting the stage for future advancements. Since then, researchers have contributed extensively to model development, mainly focusing on the plant disease cycle which outline pathogen development stages, such as dormancy, reproduction, dispersal, and pathogenesis, driven by interactions among host, pathogen, and environmental factors <span class="citation" data-cites="dewolf2007">(<a href="references.html#ref-dewolf2007" role="doc-biblioref">De Wolf and Isard 2007</a>)</span>.</p>
<p>A systematic map by <span class="citation" data-cites="fedele2022a">Fedele et al. (<a href="references.html#ref-fedele2022a" role="doc-biblioref">2022</a>)</span> identified over 750 papers on plant disease models, primarily aimed at understanding system interactions (n = 680). This map revealed that while most models focus on system understanding, fewer are devoted to tactical management (n = 40), strategic planning (n = 38), or scenario analysis (n = 9).</p>
<p>In terms of model development, we can classify the models into two main groups based on the approach taken <span class="citation" data-cites="gonzález-domínguez2023">(<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">González-Domínguez et al. 2023</a>)</span>: Empirical or mechanistic approaches, which differ fundamentally in their basis, complexity and application (<a href="#fig-approaches_modeling" class="quarto-xref">Figure&nbsp;<span>20.1</span></a>).</p>
<div id="fig-approaches_modeling" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-approaches_modeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-fig1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="614">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-approaches_modeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: Steps of model development from data collection to modeling based on statistical relationships (data-driven) between data collected from field or controlled environment to mechanistic approach based on the elements of the disease cycles (concept-driven).
</figcaption>
</figure>
</div>
<p><strong>Empirical models</strong>, which emerged in the mid-20th century, rely on data-driven statistical relationships between variables collected under varying field or controlled environments. These models often lack cause-effect understanding, making them less robust and requiring rigorous validation and calibration when applied in diverse environments, especially in regions that did not provide data for model construction. The parameters of the model change every time new data are incorporated during model development.</p>
<p>In contrast, <strong>mechanistic models</strong>, developed from a deep understanding of biological and epidemiological processes, explain disease dynamics based on known system behaviors in response to external variables—a concept-driven approach. These dynamic models quantitatively characterize the state of the pathosystem over time, offering generally more robust predictions by utilizing mathematical equations to describe how epidemics evolve under varying environmental conditions.</p>
<p>Both empirical and mechanistic approaches are valid methodologies extensively used in plant pathology research. The choice between these approaches depends on several factors, including data availability, urgency in model development, and, frequently, the researcher’s experience or preference. Empirical models focus on statistical relationships derived directly from data, whereas mechanistic models aim to represent the biological processes of disease progression through linked mathematical equations.</p>
<p>In mechanistic modeling, the equations used to predict specific disease components—such as infection frequency or the latency period—are often empirically derived from controlled experiments. For example, an infection frequency equation is typically based on data collected under specific environmental conditions, with models fitted to accurately describe observed patterns. These process-based models are then built by integrating empirically-derived equations or rules, which collectively simulate the disease cycle. Data and equations are sourced from published studies or generated from new experiments conducted by researchers.</p>
<p>Beyond their practical predictive value, mechanistic models are valuable tools for organizing existing knowledge about a particular disease, helping to identify gaps and guide future research efforts. An example of such work is the extensive collection of comprehensive mechanistic models developed for various plant diseases by the research group led by Prof.&nbsp;Vittorio Rossi in Italy <span class="citation" data-cites="rossi2008 rossi2014 salotti2023 salotti2022">(<a href="references.html#ref-rossi2008" role="doc-biblioref">Rossi et al. 2008</a>, <a href="references.html#ref-rossi2014" role="doc-biblioref">2014</a>; <a href="references.html#ref-salotti2022" role="doc-biblioref">Salotti et al. 2022</a>; <a href="references.html#ref-salotti2023" role="doc-biblioref">Salotti and Rossi 2023</a>)</span>.</p>
<p>This chapter focuses mainly on empirical modeling. We begin by examining the types of data utilized in model development, focusing on those collected under controlled conditions, such as replicated laboratory or growth chamber experiments, as well as field data collected from several locations and years. We will also analyze real-world case studies, drawing on examples from the literature to replicate and understand model applications. Through these examples, we aim to illustrate the process of fitting models to data and underscore the role of modeling in advancing plant disease management practices.</p>
</section>
<section id="controlled-environment" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="controlled-environment"><span class="header-section-number">20.2</span> Controlled environment</h2>
<p>In this section, we will demonstrate, using examples from the literature, how statistical models can be fitted to data that represent various stages of the disease cycle.</p>
<p>Research on disease-environment interactions under controlled conditions - such as laboratory or growth chamber studies - lays the groundwork for building foundational models, including infection-based models and sub-models for specific processes like dormancy, dispersal, infection, and latency <span class="citation" data-cites="krause1975 magarey2005 dewolf2007">(<a href="references.html#ref-dewolf2007" role="doc-biblioref">De Wolf and Isard 2007</a>; <a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>; <a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span>.</p>
<p>Growth chambers and phytotrons are essential for testing the effects of individual variables, though these controlled results may not fully replicate field conditions. Anyway, laboratory experiments help clarify specific questions by isolating interactions, unlike complex field trials where host, pathogen, and environment factors interact. Polycyclic or “mini epidemic” experiments enable observation of disease dynamics under targeted conditions <span class="citation" data-cites="hau1990 rotem1988">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>; <a href="references.html#ref-rotem1988" role="doc-biblioref">Rotem 1988</a>)</span>.</p>
<p>Once developed, these sub-models can be incorporated into larger mechanistic models that simulate the entire disease cycle, thereby mimicking disease progression over time <span class="citation" data-cites="rossi2008 salotti2023">(<a href="references.html#ref-rossi2008" role="doc-biblioref">Rossi et al. 2008</a>; <a href="references.html#ref-salotti2023" role="doc-biblioref">Salotti and Rossi 2023</a>)</span>. Alternatively, sub-models can also be used in stand-alone predictive systems where the process being modeled - such as infection - is the key factor in determining disease occurrence <span class="citation" data-cites="machardy1989 magarey2007">(<a href="references.html#ref-machardy1989" role="doc-biblioref">MacHardy 1989</a>; <a href="references.html#ref-magarey2007" role="doc-biblioref">Magarey and Sutton 2007</a>)</span>. For example, infection sub-models can be integrated into prediction systems that help schedule crop protection measures by forecasting when infection risk is highest.</p>
<section id="infection-based-models" class="level3" data-number="20.2.1">
<h3 data-number="20.2.1" class="anchored" data-anchor-id="infection-based-models"><span class="header-section-number">20.2.1</span> Infection-based models</h3>
<p>To model infection potential based on environmental factors, simple rules can be used with daily weather data, such as temperature and rainfall thresholds <span class="citation" data-cites="magarey2002">(<a href="references.html#ref-magarey2002" role="doc-biblioref">Magarey et al. 2002</a>)</span>. Simple decision aids, such as charts and graphs, also exist to help model infection potential by using combinations of daily average temperature and hours of wetness. These tools offer a straightforward approach to evaluate infection risks based on readily available weather data, supporting decision-making without complex modeling <span class="citation" data-cites="seem1984">(<a href="references.html#ref-seem1984" role="doc-biblioref">Seem 1984</a>)</span>. However, for many pathogens, hourly data is needed, requiring complex models that track favorable conditions hour by hour. These models start with specific triggers and can reset due to conditions like dryness or low humidity, simulating a biological clock for infection risk assessment <span class="citation" data-cites="magarey2007">(<a href="references.html#ref-magarey2007" role="doc-biblioref">Magarey and Sutton 2007</a>)</span>.</p>
<p>Modeling approaches vary based on available data and model goals. A common method is the matrix approach, like the Wallin potato late blight model, which uses rows for temperature and columns for moisture duration to estimate disease severity <span class="citation" data-cites="krause1975">(<a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>)</span> (see previous chapter on <a href="https://r4pde.net/prediction-warning-systems">warning systems</a>). Bailey enhanced this with an interactive matrix that combines temperature, relative humidity, and duration to assess infection risk across pathogens, making it versatile for various modeling needs <span class="citation" data-cites="bailey1999">(<a href="references.html#ref-bailey1999" role="doc-biblioref">Bailey 1999</a>)</span>.</p>
<p>When infection responses are measured at various temperature and wetness combinations, regression models can be developed to predict infection rates. These models often use polynomial, logistic, or complex three-dimensional response surface equations to represent the relationship between environmental conditions and infection potential. In an excellent review title “<em>How to create and deploy infection models for plant pathogen</em>s” <span class="citation" data-cites="magarey2007">Magarey and Sutton (<a href="references.html#ref-magarey2007" role="doc-biblioref">2007</a>)</span> discusses that many modeling approaches lack biological foundations and are not generic, making them unsuitable for developing a unified set of disease forecast models. While three-dimensional response surfaces, such as those created with sufficient temperature-moisture observations, offer detailed infection responses, they are often too complex and data-intensive for widespread use (seeTable 1 adapted from <span class="citation" data-cites="magarey2007">Magarey and Sutton (<a href="references.html#ref-magarey2007" role="doc-biblioref">2007</a>)</span>).</p>
<table class="caption-top table">
<caption>Comparison of different infection modeling approaches. Source: <span class="citation" data-cites="magarey2007">Magarey and Sutton (<a href="references.html#ref-magarey2007" role="doc-biblioref">2007</a>)</span></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 45%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Strengths</th>
<th>Weaknesses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Matrix <span class="citation" data-cites="krause1975 mills1944 windels1998">(<a href="references.html#ref-krause1975" role="doc-biblioref">Krause and Massie 1975</a>; <a href="references.html#ref-mills1944" role="doc-biblioref">Mills 1944</a>; <a href="references.html#ref-windels1998" role="doc-biblioref">Windels et al. 1998</a>)</span></td>
<td>Easy; converts moisture/temperature combinations into severity values or risk categories. Tried and true approach.</td>
<td>Data to populate matrix may not be readily available.</td>
</tr>
<tr class="even">
<td>Regression:<br>– Polynomial <span class="citation" data-cites="evans1992">(<a href="references.html#ref-evans1992" role="doc-biblioref">Evans 1992</a>)</span><br>– Logistic <span class="citation" data-cites="bulger1987">(<a href="references.html#ref-bulger1987" role="doc-biblioref">Bulger 1987</a>)</span></td>
<td>Widely used in plant pathology. Available for many economically important pathogens.</td>
<td>Parameters not biologically based. Requires dataset for development.</td>
</tr>
<tr class="odd">
<td>Three-dimensional response surface <span class="citation" data-cites="duthie1997">(<a href="references.html#ref-duthie1997" role="doc-biblioref">Duthie 1997</a>)</span></td>
<td>Describes infection response in detail.</td>
<td>Parameters not biologically based. Complex, requires extensive data and processing time.</td>
</tr>
<tr class="even">
<td>Degree wet hours <span class="citation" data-cites="pfender2003">(<a href="references.html#ref-pfender2003" role="doc-biblioref">Pfender 2003</a>)</span></td>
<td>Simple; based on degree hours, commonly used in entomology. Requires only Tmin and Tmax</td>
<td>Recently developed; assumes linear thermal response.</td>
</tr>
<tr class="odd">
<td>Temperature-moisture response function <span class="citation" data-cites="magarey2005">(<a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span></td>
<td>Simple; based on crop modeling functions, requires only Tmin, Topt and Tmax</td>
<td>Recently developed.</td>
</tr>
</tbody>
</table>
<p>In the following sections, I will demonstrate how various biologically meaningful models fit infection data, using temperature, wetness duration, or a combination of both as predictors.</p>
<section id="temperature-effects" class="level4" data-number="20.2.1.1">
<h4 data-number="20.2.1.1" class="anchored" data-anchor-id="temperature-effects"><span class="header-section-number">20.2.1.1</span> Temperature effects</h4>
<section id="generalized-beta-function" class="level5" data-number="20.2.1.1.1">
<h5 data-number="20.2.1.1.1" class="anchored" data-anchor-id="generalized-beta-function"><span class="header-section-number">20.2.1.1.1</span> Generalized beta-function</h5>
<p>Among several non-linear models that can be fitted to infection responses to temperature, the generalized beta-function is an interesting alternative <span class="citation" data-cites="hau1990">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>)</span>. This is a nonlinear model with five parameters. Two of them, namely <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> , have a biological meaning because they are estimates of the minimum and maximum temperature of the biological process under consideration.</p>
<p>We will use a subset of the data obtained from a study conducted under controlled conditions that aimed to assess the influence of temperature on the symptom development of citrus canker in sweet orange <span class="citation" data-cites="dallapria2006">(<a href="references.html#ref-dallapria2006" role="doc-biblioref">Dalla Pria et al. 2006</a>)</span>. The data used here is only for severity on the cultivar Hamlin (plot a in <a href="#fig-temperature" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>). The data was extracted using the R package {digitize} as shown <a href="https://twitter.com/edelponte/status/1580320409794539520?s=20&amp;t=KqjJPmwzFVKm8Gu7Ss-P6A">here on this tweet</a>.</p>
<div id="fig-temperature" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-temperature-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-fig_temperature.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" width="441">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-temperature-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: Effect of temperature (12, 15, 20, 25, 30, 35 or 40°C) on disease severity of citrus canker on sweet orange cvs Hamlin (a), Natal (b), Pera (c) and Valencia (d) with a leaf wetness duration of 24 h. Each point represents the mean of three repetitions. Vertical bars represent standard errors. Lines show the generalized beta function fitted to data. Source: <span class="citation" data-cites="dallapria2006">Dalla Pria et al. (<a href="references.html#ref-dallapria2006" role="doc-biblioref">2006</a>)</span>
</figcaption>
</figure>
</div>
<p>Let’s enter the data manually. Where <span class="math inline">\(t\)</span> is the temperature and <span class="math inline">\(y\)</span> is the severity on leaves.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>t, <span class="sc">~</span>y,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fl">12.0</span>, <span class="fl">0.00</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fl">15.0</span>, <span class="fl">0.1</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fl">20.0</span>, <span class="fl">0.5</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fl">25.0</span>, <span class="fl">1.2</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fl">30.0</span>, <span class="fl">1.5</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fl">35.0</span>, <span class="fl">1.2</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fl">40.0</span>, <span class="fl">0.1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the generalized beta-function <span class="citation" data-cites="hau1990">(<a href="references.html#ref-hau1990" role="doc-biblioref">Hau and Kranz 1990</a>)</span>. The model can be written as:</p>
<p><span class="math display">\[
y = a*((t - b )^d)*((c - t)^e)
\]</span></p>
<p>where <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> represent minimum and maximum temperatures, respectively, for the development of the disease, <span class="math inline">\(a\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(e\)</span> are parameters to be estimated, <span class="math inline">\(t\)</span> is the temperature and <span class="math inline">\(y\)</span> is disease severity. We need the {minpack.lm} library to avoid parameterization issues.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fit_temp <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> a <span class="sc">*</span> ((t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">a =</span> <span class="dv">0</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">b =</span> <span class="dv">10</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="dv">40</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="fl">1.5</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="dv">1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y ~ a * ((t - b)^d) * ((c - t)^e)

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)    
a  0.001303   0.006295   0.207    0.855    
b 11.999999   4.875412   2.461    0.133    
c 40.137236   0.346763 115.748 7.46e-05 ***
d  1.760101   1.193017   1.475    0.278    
e  0.830868   0.445213   1.866    0.203    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1121 on 2 degrees of freedom

Algorithm "port", convergence message: Relative error between `par' and the solution is at most `ptol'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_temp, temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9898275</code></pre>
</div>
</div>
<p>Store the model parameters in objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          a           b           c           d           e 
 0.00130259 11.99999936 40.13723602  1.76010097  0.83086798 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">4</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a data frame for predictions at each temperature unit from 10 to 45 degree Celsius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="fl">0.1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> a <span class="sc">*</span> ((t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the observed and predicted data using {ggplot2} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, y)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp, <span class="fu">aes</span>(t, y)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Severity"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Generalized beta-function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analytis-beta-function" class="level5" data-number="20.2.1.1.2">
<h5 data-number="20.2.1.1.2" class="anchored" data-anchor-id="analytis-beta-function"><span class="header-section-number">20.2.1.1.2</span> Analytis beta function</h5>
<p><span class="citation" data-cites="ji2023a">Ji et al. (<a href="references.html#ref-ji2023a" role="doc-biblioref">2023</a>)</span> tested and compared various mathematical equations to describe the response of mycelial growth to temperature for several fungi associated with Grapevine trunk diseases. The authors found that the beta equation <span class="citation" data-cites="analytis1977">(<a href="references.html#ref-analytis1977" role="doc-biblioref">Analytis 1977</a>)</span> provided the best fit and, therefore, was considered the most suitable for all fungi.</p>
<p>The model equation for re-scaled severity (0 to 1) as a function of temperature is given by:</p>
<p><span class="math inline">\(Y = \left( a \cdot T_{eq}^b \cdot (1 - T_{eq}) \right)^c \quad ; \quad \text{if } Y &gt; 1, \text{ then } Y = 1\)</span></p>
<p>where</p>
<p><span class="math inline">\(T_{eq} = \frac{T - T_{\text{min}}}{T_{\text{max}} - T_{\text{min}}}\)</span></p>
<p><span class="math inline">\(T\)</span> is the temperature in degrees Celsius. <span class="math inline">\(T_{\text{min}}\)</span> is the minimum temperature, <span class="math inline">\(T_{\text{max}}\)</span> is the maximum temperature for severity. The <span class="math inline">\(a\)</span> , <span class="math inline">\(b\)</span> , and <span class="math inline">\(c\)</span> are parameters that define the top, symmetry, and size of the unimodal curve.</p>
<p>Let’s rescale (0 to 1) the data on the citrus canker using the function rescale of the {scales} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    discard</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>yscaled <span class="ot">&lt;-</span> <span class="fu">rescale</span>(temp<span class="sc">$</span>y)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
      t     y yscaled
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1    12   0    0     
2    15   0.1  0.0667
3    20   0.5  0.333 
4    25   1.2  0.8   
5    30   1.5  1     
6    35   1.2  0.8   
7    40   0.1  0.0667</code></pre>
</div>
</div>
<p>Now we can fit the model using the same <code>nlsLM</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the minimum and maximum temperatures</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fit_temp2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> (a <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>), <span class="co"># Initial guesses for parameters</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_temp2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: yscaled ~ (a * ((t - Tmin)/(Tmax - Tmin))^b * (1 - ((t - Tmin)/(Tmax - 
    Tmin))))^c

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)    
a   6.7625     0.3218  21.013 3.03e-05 ***
b   1.9648     0.1030  19.072 4.45e-05 ***
c   1.1607     0.1507   7.701  0.00153 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03955 on 4 degrees of freedom

Algorithm "port", convergence message: Relative error in the sum of squares is at most `ftol'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_temp2, temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9948325</code></pre>
</div>
</div>
<p>Lets’s store the model parameters in objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a        b        c 
6.762509 1.964817 1.160702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, we create a data frame for predictions at each temperature unit from 10 to 45 degree Celsius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="fl">0.1</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> (a <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now we can plot the observed and predicted data using {ggplot2} package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, y)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp, <span class="fu">aes</span>(t, yscaled)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Scaled severity"</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Analytis beta function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="moisture-effects" class="level4" data-number="20.2.1.2">
<h4 data-number="20.2.1.2" class="anchored" data-anchor-id="moisture-effects"><span class="header-section-number">20.2.1.2</span> Moisture effects</h4>
<section id="monomolecular-function" class="level5" data-number="20.2.1.2.1">
<h5 data-number="20.2.1.2.1" class="anchored" data-anchor-id="monomolecular-function"><span class="header-section-number">20.2.1.2.1</span> Monomolecular function</h5>
<p>For this example, we will use a subset of the data obtained from a study conducted under controlled conditions that aimed to assess the effects of moisture duration on the symptom development of citrus canker in sweet orange <span class="citation" data-cites="dallapria2006">(<a href="references.html#ref-dallapria2006" role="doc-biblioref">Dalla Pria et al. 2006</a>)</span>. As in the previous example for temperature effects, the data used here is only for severity on the cultivar Hamlin (plot a in <a href="#fig-moisture" class="quarto-xref">Figure&nbsp;<span>20.3</span></a>). The data was also extracted using the R package digitize.</p>
<p>Let’s look at the original data and the predictions by the model fitted in the paper.</p>
<div id="fig-moisture" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-moisture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-fig2.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" width="516">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-moisture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.3: Effect of leaf wetness duration (0, 4, 8, 12, 16, 20 or 24 h) on disease severity of citrus canker on sweet orange cvs Hamlin (a), Natal (b), Pera (c) and Valencia (d) at 30°C. Each point represents the mean of three repetitions. Vertical bars represent standard errors. Lines show the monomolecular model fitted to data. Source: <span class="citation" data-cites="dallapria2006">Dalla Pria et al. (<a href="references.html#ref-dallapria2006" role="doc-biblioref">2006</a>)</span>
</figcaption>
</figure>
</div>
<p>For this pattern in the data, we will fit a three-parameter asymptotic regression model. These models describe a limited growth, where y approaches an horizontal asymptote as x tends to infinity. This equation is also known as Monomolecular Growth, Mitscherlich law or von Bertalanffy law. See <a href="https://www.statforbiology.com/nonlinearregression/usefulequations">this tutorial</a> for comprehensive information about fitting several non-linear regression models in R.</p>
<p>Again, we enter the data manually. The 𝑥x is wetness duration in hours and 𝑦y is severity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wet <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span> x, <span class="sc">~</span> y,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">0</span> ,  <span class="dv">0</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">4</span> ,  <span class="fl">0.50</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">8</span> ,  <span class="fl">0.81</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">12</span>,  <span class="fl">1.50</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">16</span>,  <span class="fl">1.26</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">20</span>,  <span class="fl">2.10</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">24</span>,  <span class="fl">1.45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model can be written as:</p>
<p><span class="math inline">\(y = c1 + (d1-c1)*(1-exp(-x/e1))\)</span></p>
<p>where <span class="math inline">\(c\)</span> is the lower limit (at <span class="math inline">\(x = 0\)</span>), the parameter <span class="math inline">\(d\)</span> is the upper limit and the parameter <span class="math inline">\(e\)</span> (greater than 0) is determining the steepness of the increase as <span class="math inline">\(x\)</span>.</p>
<p>We will solve the model again using the <code>nlsLM</code> function. We should provide initial values for the three parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit_wet <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(y <span class="sc">~</span> c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">/</span> e1)),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">c1 =</span> <span class="fl">0.5</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">d1 =</span> <span class="dv">3</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">e1 =</span> <span class="dv">1</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> wet)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y ~ c1 + (d1 - c1) * (1 - exp(-x/e1))

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)  
c1 -0.04898    0.31182  -0.157   0.8828  
d1  2.00746    0.70594   2.844   0.0467 *
e1 11.63694    9.33184   1.247   0.2804  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3296 on 4 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_wet, wet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8532282</code></pre>
</div>
</div>
<p>Store the value of the parameters in the respective object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>HW <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span>  fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  (c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>HW <span class="sc">/</span> e1)))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(HW, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can plot the predictions and the original data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(HW, y)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> wet, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wetness duration"</span>, <span class="at">y =</span> <span class="st">"Severity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="weibull-function" class="level5" data-number="20.2.1.2.2">
<h5 data-number="20.2.1.2.2" class="anchored" data-anchor-id="weibull-function"><span class="header-section-number">20.2.1.2.2</span> Weibull function</h5>
<p>In the study by <span class="citation" data-cites="ji2021 ji2023a">(<a href="references.html#ref-ji2021" role="doc-biblioref">Ji et al. 2021</a>, <a href="references.html#ref-ji2023a" role="doc-biblioref">2023</a>)</span>, a Weibull model was fitted to the re-scaled data (0 to 1) on the effect of moisture duration on spore germination or infection. Let’s keep working with the re-scaled data on the citrus canker.</p>
<p>The model is given by:</p>
<p><span class="math inline">\(y = 1 - \exp(-(a \cdot x)^b)\)</span></p>
<p>where <span class="math inline">\(y\)</span> is the response variable, <span class="math inline">\(x\)</span> is the moist duration, <span class="math inline">\(a\)</span> is the scale parameter influencing the rate of infection and <span class="math inline">\(b\)</span> is the shape parameter affecting the curve’s shape and acceleration</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>wet<span class="sc">$</span>yscaled <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wet<span class="sc">$</span>y) </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>wet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
      x     y yscaled
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1     0  0      0    
2     4  0.5    0.238
3     8  0.81   0.386
4    12  1.5    0.714
5    16  1.26   0.6  
6    20  2.1    1    
7    24  1.45   0.690</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_wet2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(a <span class="sc">*</span> x)<span class="sc">^</span>b),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> wet,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>),  <span class="co"># Initial guesses for parameters a and b</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wet2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: yscaled ~ 1 - exp(-(a * x)^b)

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)   
a  0.07684    0.01296    5.93  0.00195 **
b  1.07610    0.37103    2.90  0.03378 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1404 on 5 degrees of freedom

Number of iterations to convergence: 26 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>modelr<span class="sc">::</span><span class="fu">rsquare</span>(fit_wet2, wet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8534077</code></pre>
</div>
</div>
<p>Set the value of the parameters in the respective objects</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span>  fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(a <span class="sc">*</span> x)<span class="sc">^</span>b)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dat3 <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> wet, <span class="fu">aes</span>(x, yscaled)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wetness duration"</span>, <span class="at">y =</span> <span class="st">"Scaled severity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="integrating-temperature-and-wetness-effects" class="level4" data-number="20.2.1.3">
<h4 data-number="20.2.1.3" class="anchored" data-anchor-id="integrating-temperature-and-wetness-effects"><span class="header-section-number">20.2.1.3</span> Integrating temperature and wetness effects</h4>
<p>The equations developed for the separate effects can be integrated to create a surface response curve or a simple contour plot. Let’s first integrate the generalized beta and the monomolecular models for the original severity data for the citrus canker experiment.</p>
<p>First, we need a data frame for the interaction between temperature <span class="math inline">\(t\)</span> and hours of wetness <span class="math inline">\(hw\)</span>. Then, we obtain the disease value for each combination of <span class="math inline">\(t\)</span> and <span class="math inline">\(hw\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">40</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">each =</span> <span class="dv">40</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># let's fit the two models again and store the parameters in objects</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature effects</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>fit_temp <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> a <span class="sc">*</span> ((t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">a =</span> <span class="dv">0</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">b =</span> <span class="dv">10</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="dv">40</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> <span class="fl">1.5</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="dv">1</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          a           b           c           d           e 
 0.00130259 11.99999936 40.13723602  1.76010097  0.83086798 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">4</span>]</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> fit_temp<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">5</span>]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Moist duration effects</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>fit_wet <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(y <span class="sc">~</span> c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">/</span> e1)),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">c1 =</span> <span class="fl">0.5</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">d1 =</span> <span class="dv">3</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">e1 =</span> <span class="dv">1</span>),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> wet)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span>  fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> fit_wet<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">&lt;-</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  (a <span class="sc">*</span> (t <span class="sc">-</span> b) <span class="sc">^</span> d) <span class="sc">*</span> ((c <span class="sc">-</span> t) <span class="sc">^</span> e) <span class="sc">*</span> (c1 <span class="sc">+</span> (d1 <span class="sc">-</span> c1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span> hw <span class="sc">/</span> e1)))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, hw, dis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the contour plot can be visualized using {ggplot2} and {geomtextpath} packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geomtextpath)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(validation, <span class="fu">aes</span>(t, hw, <span class="at">z =</span> dis)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">bins =</span> <span class="dv">8</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcontour</span>(<span class="at">bins =</span> <span class="dv">8</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">padding =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"in"</span>)) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Wetness duration (hours)"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Severity"</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (Celcius)"</span>,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Integrating generalized beta and monomolecular"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the second example, let’s integrate the Analytis beta and the Weibull model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_temp2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> (a <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> temp,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>), <span class="co"># Initial guesses for parameters</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">"port"</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a        b        c 
6.762509 1.964817 1.160702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> fit_temp2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">3</span>]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>fit_wet2 <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  yscaled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(d <span class="sc">*</span> x)<span class="sc">^</span>e),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> wet,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="dv">1</span>, <span class="at">e =</span> <span class="dv">2</span>),  <span class="co"># Initial guesses for parameters a and b</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span>  fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> fit_wet2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>dis2 <span class="ot">&lt;-</span>  (a2 <span class="sc">*</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))<span class="sc">^</span>b2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> ((t <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Tmin))))<span class="sc">^</span>c2 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(d2 <span class="sc">*</span> hw)<span class="sc">^</span>e2)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">40</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">each =</span> <span class="dv">40</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>validation2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(t, hw, dis2)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>validation2 <span class="ot">&lt;-</span> validation2 <span class="sc">|&gt;</span> </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dis2 <span class="sc">!=</span> <span class="st">"NaN"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dis2 =</span> <span class="fu">case_when</span>(dis2 <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> dis2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(validation2, <span class="fu">aes</span>(t, hw, <span class="at">z =</span> dis2)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">bins =</span> <span class="dv">7</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcontour</span>(<span class="at">bins =</span> <span class="dv">7</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">padding =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"in"</span>)) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Wetness duration (hours)"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Severity"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (Celcius)"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Integrating generalized beta and monomolecular"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can create a 3D surface plot to visualize the predictions, as <a href="https://bsppjournals.onlinelibrary.wiley.com/cms/asset/0acf45ce-bad8-4a49-9a17-181836aa9876/ppa_1393_f3.gif">it was used in the original paper</a>. Note that In <code>plot_ly</code>, a 3D surface plot requires a matrix or grid format for the <code>z</code> values, with corresponding vectors for <code>x</code> and <code>y</code> values that define the axes. If the data frame (<code>validation2</code>) has three columns (<code>t</code>, <code>hw</code>, and <code>dis2</code>), we’ll need to convert <code>dis2</code> into a matrix format that <code>plot_ly</code> can interpret for a surface plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>z_matrix <span class="ot">&lt;-</span> <span class="fu">acast</span>(validation2, hw <span class="sc">~</span> t, <span class="at">value.var =</span> <span class="st">"dis2"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(validation2<span class="sc">$</span>t))  </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>y_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(validation2<span class="sc">$</span>hw)) </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>x_vals, <span class="at">y =</span> <span class="sc">~</span>y_vals, <span class="at">z =</span> <span class="sc">~</span>z_matrix, <span class="at">type =</span> <span class="st">"surface"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">config</span>(<span class="at">displayModeBar =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">nticks =</span> <span class="dv">10</span>),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Wetness Duration (hours)"</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Severity"</span>),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">aspectratio =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">z =</span> <span class="dv">1</span>)  </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Integrating Generalized Beta and Monomolecular"</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7d3739c51ca9875329e0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7d3739c51ca9875329e0">{"x":{"visdat":{"aa4c78b4d116":["function () ","plotlyVisDat"]},"cur_data":"aa4c78b4d116","attrs":{"aa4c78b4d116":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Temperature (°C)","nticks":10},"yaxis":{"title":"Wetness Duration (hours)","range":[0,40]},"zaxis":{"title":"Severity"},"aspectratio":{"x":1,"y":1,"z":1}},"title":"Integrating Generalized Beta and Monomolecular","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"z_matrix","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"z":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.020947694132832373,0.057384573297643904,0.077230206950872682,0.078258676120725901,0.058386690942224817,0.015730531346323851,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.033762749915840051,0.08446510582329847,0.12090198498811,0.14074761864133878,0.141776087811192,0.12190410263269091,0.079247943036789947,0.0122037295877373,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.032721048885429149,0.095297112477565782,0.1459994683850242,0.18243634754983573,0.20228198120306451,0.20331045037291773,0.18343846519441664,0.14078230559851568,0.07373809214946303,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.019351163855817033,0.091371292312893315,0.15394735590502995,0.20464971181248837,0.2410865909772999,0.26093222463052868,0.26196069380038189,0.24208870862188081,0.19943254902597984,0.1323883355769272,0.039753054281635225,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.074790333687643873,0.14681046214472016,0.20938652573685679,0.26008888164431521,0.29652576080912674,0.31637139446235552,0.31739986363220873,0.29752787845370765,0.25487171885780668,0.18782750540875404,0.095192224113462065,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0.047900347494019724,0.12692153951611718,0.19894166797319346,0.26151773156533009,0.31222008747278851,0.34865696663760004,0.36850260029082882,0.36953106946068204,0.34965908428218095,0.30700292468627999,0.23995871123722734,0.14732342994193537,0.02849331834837221,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0.013153336797770865,0.096741646029262052,0.1757628380513595,0.24778296650843579,0.31035903010057242,0.36106138600803084,0.39749826517284237,0.41734389882607115,0.41837236799592437,0.39850038281742328,0.35584422322152232,0.28880000977246967,0.1961647284771777,0.077334616883614538,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0.05878620711756577,0.14237451634905696,0.22139570837115441,0.29341583682823069,0.35599190042036732,0.40669425632782574,0.44313113549263727,0.46297676914586605,0.46400523831571927,0.44413325313721819,0.40147709354131722,0.33443288009226457,0.2417975987969726,0.12296748720340944,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0.015576470095582273,0.10132851251883124,0.18491682175032242,0.26393801377241988,0.33595814222949616,0.39853420582163279,0.44923656172909121,0.48567344089390274,0.50551907454713152,0.50654754371698474,0.48667555853848365,0.44401939894258269,0.37697518549353004,0.28433990419823807,0.16550979260467491,0.020844084446482447,0,0,0],[0,0,0,0,0,0,0,0,0,0,0.055166792480272175,0.14091883490352114,0.22450714413501233,0.30352833615710978,0.37554846461418606,0.43812452820632269,0.48882688411378111,0.52526376327859259,0.54510939693182148,0.5461378661016747,0.5262658809231735,0.48360972132727259,0.41656550787821994,0.32393022658292797,0.20510011498936481,0.060434406831172349,0,0,0],[0,0,0,0,0,0,0,0,0,0.0063901141470076861,0.091954748201850456,0.17770679062509942,0.26129509985659061,0.34031629187868806,0.41233642033576434,0.47491248392790097,0.52561483983535939,0.56205171900017092,0.5818973526533997,0.58292582182325292,0.56305383664475184,0.52039767704885087,0.45335346359979822,0.36071818230450625,0.24188807071094309,0.09722236255275063,0,0,0],[0,0,0,0,0,0,0,0,0,0.040530107226282475,0.12609474128112524,0.21184678370437421,0.2954350929358654,0.37445628495796285,0.44647641341503913,0.50905247700717582,0.55975483291463424,0.59619171207944577,0.61603734573267444,0.61706581490252765,0.59719382972402668,0.55453767012812571,0.48749345667907301,0.39485817538378104,0.27602806379021788,0.13136235563202542,0,0,0],[0,0,0,0,0,0,0,0,0,0.072177191810116947,0.15774182586495972,0.24349386828820868,0.32708217751969987,0.40610336954179732,0.4781234979988736,0.54069956159101018,0.5914019174984686,0.62783879666328013,0.64768443031650902,0.64871289948636224,0.62884091430786104,0.58618475471196008,0.51914054126290754,0.42650525996761551,0.30767514837405235,0.16300944021585989,0,0,0],[0,0,0,0,0,0,0,0,0.018382984623872112,0.10148429471524639,0.18704892877008916,0.27280097119333813,0.35638928042482931,0.43541047244692677,0.50743060090400305,0.57000666449613968,0.6207090204035981,0.65714589956840963,0.67699153322163841,0.67802000239149163,0.65814801721299054,0.61549185761708958,0.54844764416803693,0.45581236287274496,0.3369822512791818,0.19231654312098934,0.023924351496224072,0,0],[0,0,0,0,0,0,0,0,0.045499038715348106,0.12860034880672239,0.21416498286156516,0.29991702528481412,0.38350533451630531,0.46252652653840276,0.53454665499547904,0.59712271858761568,0.64782507449507409,0.68426195365988562,0.7041075873131144,0.70513605648296762,0.68526407130446654,0.64260791170856557,0.57556369825951292,0.48292841696422095,0.36409830537065779,0.21943259721246533,0.051040405587700066,0,0],[0,0,0,0,0,0,0,0,0.070567744086310835,0.15366905417768512,0.23923368823252789,0.32498573065577685,0.40857403988726804,0.48759523190936549,0.55961536036644177,0.6221914239585784,0.67289377986603682,0.70933065903084835,0.72917629268407713,0.73020476185393035,0.71033277667542927,0.6676766170795283,0.60063240363047565,0.50799712233518368,0.38916701074162052,0.24450130258342806,0.076109110958662796,0,0],[0,0,0,0,0,0,0,0.015263809606941958,0.093726771391593799,0.17682808148296808,0.26239271553781085,0.34814475796105981,0.431733067192551,0.51075425921464845,0.58277438767172474,0.64535045126386137,0.69605280717131979,0.73248968633613132,0.7523353199893601,0.75336378915921332,0.73349180398071223,0.69083564438481126,0.62379143093575862,0.53115614964046665,0.41232603804690349,0.26766032988871102,0.09926813826394576,0,0],[0,0,0,0,0,0,0,0.036644319676398529,0.11510728146105037,0.19820859155242465,0.28377322560726742,0.36952526803051639,0.45311357726200757,0.53213476928410497,0.60415489774118125,0.66673096133331788,0.7174333172407763,0.75387019640558783,0.77371583005881672,0.77474429922866994,0.75487231405016875,0.71221615445426778,0.64517194100521524,0.55253665970992327,0.43370654811636006,0.28904083995816759,0.12064864833340233,0,0],[0,0,0,0,0,0,0,0.056370711696431181,0.13483367348108302,0.2179349835724573,0.30349961762730004,0.38925166005054901,0.4728399692820402,0.55186116130413765,0.62388128976121393,0.68645735335335056,0.73715970926080898,0.77359658842562051,0.79344222207884929,0.79447069124870251,0.77459870607020143,0.73194254647430046,0.66489833302524781,0.57226305172995584,0.45343294013639268,0.30876723197820022,0.14037504035343498,0,0],[0,0,0,0,0,0,0.0027797863651659871,0.074560537448874808,0.15302349923352665,0.23612480932490093,0.3216894433797437,0.40744148580299266,0.49102979503448385,0.5700509870565813,0.64207111551365759,0.70464717910579422,0.75534953501325264,0.79178641417806417,0.81163204783129295,0.81266051700114617,0.79278853182264508,0.75013237222674412,0.68308815877769147,0.5904528774823995,0.47162276588883634,0.32695705773064387,0.15856486610587861,0,0],[0,0,0,0,0,0,0.01954378514400601,0.091324536227714831,0.16978749801236667,0.25288880810374093,0.33845344215858375,0.42420548458183271,0.5077937938133239,0.58681498583542135,0.65883511429249764,0.72141117788463427,0.77211353379209269,0.80855041295690422,0.828396046610133,0.82942451577998622,0.80955253060148513,0.76689637100558417,0.69985215755653152,0.60721687626123955,0.48838676466767639,0.34372105650948392,0.17532886488471863,0,0],[0,0,0,0,0,0,0.034986005911865042,0.10676675699557386,0.18522971878022571,0.26833102887159999,0.35389566292644276,0.43964770534969172,0.52323601458118296,0.6022572066032803,0.67427733506035659,0.73685339865249322,0.78755575455995164,0.82399263372476317,0.84383826737799206,0.84486673654784528,0.82499475136934408,0.78233859177344311,0.71529437832439058,0.62265909702909861,0.50382898543553534,0.35916327727734293,0.19077108565257767,0.0047806794252760465,0],[0,0,0,0,0,0,0.049203991764441707,0.12098474284815053,0.19944770463280237,0.28254901472417665,0.36811364877901942,0.45386569120226838,0.53745400043375957,0.61647519245585702,0.68849532091293331,0.75107138450506994,0.80177374041252836,0.83821061957733989,0.85805625323056867,0.85908472240042189,0.8392127372219208,0.79655657762601983,0.72951236417696719,0.63687708288167522,0.51804697128811206,0.37338126312991959,0.20498907150515433,0.018998665277852711,0],[0,0,0,0,0,0,0.062289007944925534,0.13406975902863436,0.2125327208132862,0.29563403090466045,0.38119866495950328,0.46695070738275224,0.55053901661424343,0.62956020863634088,0.70158033709341716,0.76415640068555379,0.81485875659301221,0.85129563575782374,0.87114126941105252,0.87216973858090574,0.85229775340240466,0.80964159380650369,0.74259738035745104,0.64996209906215907,0.53113198746859591,0.38646627931040345,0.21807408768563816,0.032083681458336538,0],[0,0,0,0,0,0.011102565507374845,0.074326299204323099,0.14610705028803192,0.22457001207268376,0.30767132216405801,0.39323595621890084,0.4789879986421498,0.56257630787364099,0.64159749989573844,0.71361762835281473,0.77619369194495136,0.82689604785240978,0.86333292701722131,0.88317856067045009,0.8842070298403033,0.86433504466180222,0.82167888506590125,0.75463467161684861,0.66199939032155664,0.54316927872799348,0.39850357056980101,0.23011137894503572,0.044120972717734103,0],[0,0,0,0,0,0.022171632012530862,0.085395365709479115,0.15717611679318794,0.23563907857783978,0.31874038866921406,0.40430502272405683,0.49005706514730579,0.57364537437879703,0.65266656640089438,0.72468669485797066,0.78726275845010729,0.83796511435756571,0.87440199352237724,0.89424762717560613,0.89527609634545935,0.87540411116695815,0.83274795157105719,0.76570373812200465,0.67306845682671268,0.55423834523314941,0.409572637074957,0.24118044545019174,0.055190039222890119,0],[0,0,0,0,0,0.032346515581032839,0.095570249277981092,0.16735100036168993,0.24581396214634177,0.32891527223771605,0.41447990629255882,0.50023194871580778,0.58382025794729897,0.66284144996939642,0.73486157842647271,0.79743764201860934,0.84813999792606776,0.88457687709087929,0.90442251074410807,0.90545097991396128,0.8855789947354602,0.84292283513955923,0.77587862169050659,0.68324334039521462,0.56441322880165146,0.41974752064345899,0.25135532901869373,0.065364922791392097,0],[0,0,0,0,0,0.041696089992078661,0.10491982368902691,0.17670057477273574,0.25516353655738755,0.33826484664876189,0.4238294807036046,0.50958152312685356,0.59316983235834475,0.6721910243804422,0.74421115283751849,0.80678721642965512,0.85748957233711354,0.89392645150192507,0.91377208515515385,0.91480055432500706,0.89492856914650598,0.85227240955060501,0.78522819610155237,0.6925929148062604,0.57376280321269724,0.42909709505450477,0.26070490342973951,0.074714497202437918,0],[0,0,0,0,0,0.050284350640351805,0.11350808433730006,0.18528883542100888,0.26375179720566072,0.346853107297035,0.43241774135187777,0.51816978377512668,0.60175809300661798,0.68077928502871532,0.7527994134857916,0.81537547707792823,0.86607783298538665,0.90251471215019818,0.92236034580342707,0.92338881497328029,0.9035168297947791,0.86086067019887813,0.79381645674982559,0.70118117545453362,0.58235106386097035,0.43768535570277795,0.26929316407801268,0.083302757850711062,0],[0,0,0,0,0.0051589349460192252,0.058170699977401263,0.12139443367434952,0.19317518475805834,0.27163814654271018,0.35473945663408446,0.44030409068892723,0.52605613311217625,0.60964444234366733,0.68866563436576489,0.76068576282284117,0.8232618264149778,0.87396418232243622,0.91040106148724775,0.93024669514047642,0.93127516431032964,0.91140317913182867,0.8687470195359277,0.80170280608687494,0.70906752479158297,0.59023741319801992,0.4455717050398274,0.27717951341506214,0.091189107187760521,0],[0,0,0,0,0.01239846107163517,0.065410226103017208,0.12863395979996545,0.2004147108836743,0.27887767266832614,0.36197898275970042,0.44754361681454319,0.5332956592377921,0.61688396846928328,0.69590516049138074,0.76792528894845702,0.83050135254059365,0.88120370844805207,0.9176405876128636,0.93748622126609238,0.9385146904359456,0.91864270525744451,0.87598654566154355,0.8089423322124909,0.71630705091719893,0.59747693932363577,0.45281123116544336,0.2844190395406781,0.098428633313376465,0],[0,0,0,0,0.019042207556016613,0.072053972587398651,0.1352777062843469,0.20705845736805573,0.28552141915270757,0.36862272924408185,0.45418736329892462,0.53993940572217358,0.62352771495366477,0.70254890697576222,0.7745690354328385,0.83714509902497514,0.88784745493243356,0.92428433409724509,0.94412996775047386,0.94515843692032708,0.925286451741826,0.88263029214592503,0.81558607869687239,0.72295079740158041,0.60412068580801725,0.45945497764982479,0.29106278602505953,0.10507237979775791,0],[0,0,0,0,0.025137433136809217,0.078149198168191256,0.1413729318651395,0.21315368294884834,0.29161664473350019,0.37471795482487447,0.46028258887971724,0.54603463130296614,0.62962294053445733,0.70864413255655478,0.78066426101363107,0.8432403246057677,0.89394268051322612,0.93037955967803765,0.95022519333126643,0.95125366250111965,0.93138167732261856,0.8887255177267176,0.82168130427766495,0.72904602298237298,0.61021591138880982,0.46555020323061741,0.29715801160585215,0.11116760537855051,0],[0,0,0,0,0.030727860377120234,0.083739625408502272,0.14696335910545053,0.21874411018915935,0.29720707197381119,0.38030838206518547,0.46587301612002824,0.55162505854327715,0.63521336777476844,0.71423455979686579,0.78625468825394207,0.8488307518460787,0.89953310775353712,0.93596998691834865,0.95581562057157754,0.95684408974143076,0.93697210456292956,0.8943159449670286,0.82727173151797606,0.73463645022268409,0.61580633862912082,0.47114063047092841,0.30274843884616315,0.11675803261886153,0],[0,0,0,0,0.035853912717181649,0.088865677748563687,0.15208941144551194,0.22387016252922076,0.3023331243138726,0.38543443440524688,0.47099906846008965,0.55675111088333862,0.6403394201148298,0.71936061213692726,0.79138074059400354,0.85395680418614017,0.90465916009359859,0.94109603925841012,0.9609416729116389,0.96197014208149212,0.94209815690299104,0.89944199730709007,0.83239778385803742,0.73976250256274545,0.62093239096918229,0.47626668281098983,0.30787449118622456,0.12188408495892294,0],[0,0,0,0,0.040552939623338537,0.093564704654720582,0.15678843835166884,0.22856918943537766,0.30703215122002947,0.39013346131140375,0.47569809536624652,0.56145013778949548,0.64503844702098667,0.72405963904308412,0.79607976750016041,0.85865583109229704,0.90935818699975546,0.94579506616456699,0.96564069981779577,0.96666916898764899,0.9467971838091479,0.90414102421324694,0.83709681076419429,0.74446152946890232,0.62563141787533916,0.48096570971714669,0.31257351809238143,0.12658311186507984,0],[0,0,0,0.0034205896149966802,0.044859429748971731,0.097871194780353776,0.16109492847730203,0.23287567956101085,0.31133864134566269,0.39443995143703697,0.48000458549187974,0.56575662791512871,0.64934493714661989,0.72836612916871735,0.80038625762579363,0.86296232121793026,0.91366467712538868,0.95010155629020021,0.96994718994342899,0.97097565911328221,0.95110367393478112,0.90844751433888016,0.84140330088982751,0.74876801959453554,0.62993790800097238,0.48527219984277992,0.31688000821801465,0.13088960199071303,0],[0,0,0,0.0073663720509898542,0.048805212184964905,0.10181697721634694,0.1650407109132952,0.23682146199700402,0.31528442378165589,0.39838573387303011,0.48395036792787294,0.5697024103511219,0.65329071958261309,0.73231191160471054,0.80433204006178682,0.86690810365392346,0.91761045956138187,0.95404733872619341,0.97389297237942218,0.9749214415492754,0.95504945637077432,0.91239329677487335,0.8453490833258207,0.75271380203052873,0.63388369043696557,0.48921798227877311,0.32082579065400785,0.1348353844267062,0],[0,0,0,0.010980805868016412,0.052419646001991463,0.1054314110333735,0.16865514473032175,0.24043589581403058,0.31889885759868242,0.4020001676900567,0.48756480174489947,0.57331684416814843,0.65690515339963962,0.73592634542173707,0.80794647387881335,0.87052253747094999,0.9212248933784084,0.95766177254321994,0.97750740619644871,0.97853587536630193,0.95866389018780085,0.91600773059189988,0.84896351714284723,0.75632823584755526,0.6374981242539921,0.49283241609579964,0.32444022447103438,0.13844981824373276,0],[0,0,0,0.014290958246870752,0.055729798380845803,0.10874156341222785,0.1719652971091761,0.24374604819288492,0.32220900997753676,0.40531032006891105,0.49087495412375381,0.57662699654700278,0.66021530577849397,0.73923649780059142,0.8112566262576677,0.87383268984980433,0.92453504575726275,0.96097192492207428,0.98081755857530306,0.98184602774515628,0.9619740425666552,0.91931788297075423,0.85227366952170158,0.75963838822640961,0.64080827663284645,0.49614256847465399,0.32775037684988872,0.14175997062258711,0]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="magareys-generic-infection-model" class="level4" data-number="20.2.1.4">
<h4 data-number="20.2.1.4" class="anchored" data-anchor-id="magareys-generic-infection-model"><span class="header-section-number">20.2.1.4</span> Magarey’s generic infection model</h4>
<p>In the early 2000s, Magarey and collaborators <span class="citation" data-cites="magarey2005">(<a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span> proposed a generic infection model for foliar fungal pathogens, designed to predict infection periods based on limited data on temperature and wetness requirements. The model uses cardinal temperatures (minimum, optimum, maximum) and the minimum wetness duration (Wmin) necessary for infection. The model can incorporate inputs based on estimated cardinal temperatures and surface wetness duration. These values are available for numerous pathogens and can be consulted in the literature (See table 2 of the paper by <span class="citation" data-cites="magarey2005">Magarey et al. (<a href="references.html#ref-magarey2005" role="doc-biblioref">2005</a>)</span>).</p>
<p>The model utilizes a temperature response function, which is adjusted to the pathogen’s minimum and optimum wetness duration needs, allowing it to be broadly applicable even with limited data on specific pathogens. The model was validated with data from 53 studies, showing good accuracy and adaptability, even for pathogens lacking comprehensive data <span class="citation" data-cites="magarey2005">(<a href="references.html#ref-magarey2005" role="doc-biblioref">Magarey et al. 2005</a>)</span>.</p>
<p>The function is given by</p>
<p><span class="math inline">\(f(T) = \left( \frac{T_{\text{max}} - T}{T_{\text{max}} - T_{\text{opt}}} \right)^{\frac{T_{\text{opt}} - T_{\text{min}}}{T_{\text{max}} - T_{\text{opt}}}} \times \left( \frac{T - T_{\text{min}}}{T_{\text{opt}} - T_{\text{min}}} \right)^{\frac{T_{\text{opt}} - T_{\text{min}}}{T_{\text{opt}} - T_{\text{min}}}}\)</span></p>
<p>where <span class="math inline">\(T\)</span> is the temperature, <span class="math inline">\(T_{\text{min}}\)</span> is the minimum temperature, <span class="math inline">\(T_{\text{opt}}\)</span> is the optimum temperature, and <span class="math inline">\(T_{\text{max}}\)</span> is the maximum temperature for infection.</p>
<p>The wetness duration requirement is given by</p>
<p><span class="math inline">\(W(T) = \frac{W_{\text{min}}}{f(T)} \leq W_{\text{max}}\)</span></p>
<p>where <span class="math inline">\(W_{\text{min}}\)</span> is the minimum wetness duration requirement, and <span class="math inline">\(W_{\text{max}}\)</span> is an optional upper limit on <span class="math inline">\(W(T)\)</span>.</p>
<p>Let’s write the functions for estimating the required wetness duration at each temperature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>temp_response <span class="ot">&lt;-</span> <span class="cf">function</span>(T, Tmin, Topt, Tmax) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (T <span class="sc">&lt;</span> Tmin <span class="sc">||</span> T <span class="sc">&gt;</span> Tmax) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    ((Tmax <span class="sc">-</span> T) <span class="sc">/</span> (Tmax <span class="sc">-</span> Topt))<span class="sc">^</span>((Topt <span class="sc">-</span> Tmin) <span class="sc">/</span> (Tmax <span class="sc">-</span> Topt)) <span class="sc">*</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    ((T <span class="sc">-</span> Tmin) <span class="sc">/</span> (Topt <span class="sc">-</span> Tmin))<span class="sc">^</span>((Topt <span class="sc">-</span> Tmin) <span class="sc">/</span> (Topt <span class="sc">-</span> Tmin))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to calculate wetness duration requirement W(T)</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>wetness_duration <span class="ot">&lt;-</span> <span class="cf">function</span>(T, Wmin, Tmin, Topt, Tmax, <span class="at">Wmax =</span> <span class="cn">Inf</span>) {</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  f_T <span class="ot">&lt;-</span> <span class="fu">temp_response</span>(T, Tmin, Topt, Tmax)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (f_T <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)  <span class="co"># Infinite duration required if outside temperature range</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> Wmin <span class="sc">/</span> f_T</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">min</span>(W, Wmax))  <span class="co"># Apply Wmax as an upper limit if specified</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s set the parameters for the fungus <em>Venturia inaequalis</em>, the cause of apple scab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for Venturia inaequalis (apple scab)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="at">by =</span> <span class="fl">0.5</span>) </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>Wmin <span class="ot">&lt;-</span> <span class="dv">6</span>                  </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">1</span>                  </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>Topt <span class="ot">&lt;-</span> <span class="dv">20</span>                 </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">35</span>                 </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>Wmax <span class="ot">&lt;-</span> <span class="fl">40.5</span>                </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate wetness duration required at each temperature</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>W_T <span class="ot">&lt;-</span> <span class="fu">sapply</span>(T, wetness_duration, Wmin, Tmin, Topt, Tmax, Wmax)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>temperature_data_applescab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperature =</span> T,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wetness_Duration =</span> W_T</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now the parameters for the fungus <em>Phakopsora pachyrhizi</em>, the cause of soybean rust in soybean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for Phakposora pachyrhizi</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="at">by =</span> <span class="fl">0.5</span>)  </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>Wmin <span class="ot">&lt;-</span> <span class="dv">8</span>                </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Tmin <span class="ot">&lt;-</span> <span class="dv">10</span>                  </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>Topt <span class="ot">&lt;-</span> <span class="dv">23</span>                 </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>Tmax <span class="ot">&lt;-</span> <span class="dv">28</span>                </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>Wmax <span class="ot">&lt;-</span> <span class="dv">12</span>                 </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate wetness duration required at each temperature</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>W_T <span class="ot">&lt;-</span> <span class="fu">sapply</span>(T, wetness_duration, Wmin, Tmin, Topt, Tmax, Wmax)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>temperature_data_soyrust <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperature =</span> T,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wetness_Duration =</span> W_T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can produce the plots for each pathogen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>applescab <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(temperature_data_applescab, <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Wetness_Duration)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">y =</span> <span class="st">"Wetness Duration (hours)"</span>, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Venturia inaequalis"</span>)<span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>soyrust <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(temperature_data_soyrust, <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Wetness_Duration)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">y =</span> <span class="st">"Wetness Duration (hours)"</span>, </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Phakopsora pachyrizhi"</span>)<span class="sc">+</span> </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>applescab <span class="sc">|</span> soyrust</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="latency-period-models" class="level3" data-number="20.2.2">
<h3 data-number="20.2.2" class="anchored" data-anchor-id="latency-period-models"><span class="header-section-number">20.2.2</span> Latency period models</h3>
<p>The latent period can be defined as “the length of time between the start of the infection process by a unit of inoculum and the start of production of infectious units” <span class="citation" data-cites="madden2007">(<a href="references.html#ref-madden2007" role="doc-biblioref">Madden et al. 2007</a>)</span>. The latent period, analogous to the reproductive maturity age of nonparasitic organisms, defines the generation time between infections and is a key factor in pathogen development and epidemic progress in plant disease epidemiology <span class="citation" data-cites="plantdi1963">(<a href="references.html#ref-plantdi1963" role="doc-biblioref">Vanderplank 1963</a>)</span>. As a critical trait of aggressiveness, especially in polycyclic diseases, it largely determines the potential number of infection cycles within a season, impacting the overall epidemic intensity <span class="citation" data-cites="lannou2012">(<a href="references.html#ref-lannou2012" role="doc-biblioref">Lannou 2012</a>)</span>.</p>
<section id="parabolic-function" class="level4" data-number="20.2.2.1">
<h4 data-number="20.2.2.1" class="anchored" data-anchor-id="parabolic-function"><span class="header-section-number">20.2.2.1</span> Parabolic function</h4>
<p>The effects of temperature on the length of the incubation and latent periods of hawthorn powdery mildew, caused by <em>Podosphaera clandestina</em>, were studied by <span class="citation" data-cites="xu2000">Xu and Robinson (<a href="references.html#ref-xu2000" role="doc-biblioref">2000</a>)</span>. In that work, the authors inoculated the leaves and, each day after inoculation, the upper surface of each leaf was examined for mildew colonies and conidiophores using a pen-microscope (×50). Sporulation was recorded at the leaf level, noting the number of colonies and the first appearance dates of colonies and sporulation for each leaf.</p>
<p>The latent period (LP) was defined as the time from inoculation to the first day of observed sporulation on the leaf. Due to the skewed distribution of LP across temperatures and inoculations, medians were used to summarize LP rather than means <span class="citation" data-cites="xu2000">(<a href="references.html#ref-xu2000" role="doc-biblioref">Xu and Robinson 2000</a>)</span>.</p>
<p>Let’s look at two plots extracted from the paper. The first, on the left-hand side, is the original number of days of the latent period of each evaluated temperature (note: the solid symbol is for constant temperature while the open circle is for fluctuating temperature). On the right-hand side, the relationship between temperature and rates of development of powdery mildew under constant temperature during the latent periods; the solid line indicates the fitted model. The rate of fungal development was calculated as the reciprocal of the corresponding observed incubation (in hours) and latent periods.</p>
<div id="fig-latent" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-latent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imgs/modeling-latent.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-latent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.4: Source: <span class="citation" data-cites="xu2000">Xu and Robinson (<a href="references.html#ref-xu2000" role="doc-biblioref">2000</a>)</span>
</figcaption>
</figure>
</div>
<p>The latent period data in days for the solid black circle (constant temperature) above was extracted using the {digitize} R package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>latent <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>   <span class="sc">~</span>T, <span class="sc">~</span>days,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>L,   <span class="dv">13</span>L,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">11</span>L,   <span class="dv">16</span>L,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">13</span>L,    <span class="dv">8</span>L,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">14</span>L,    <span class="dv">9</span>L,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">15</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">16</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">17</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">18</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">19</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">20</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">21</span>L,    <span class="dv">5</span>L,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">22</span>L,    <span class="dv">5</span>L,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">23</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">24</span>L,    <span class="dv">6</span>L,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span>L,    <span class="dv">5</span>L,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">26</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">27</span>L,    <span class="dv">7</span>L,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">28</span>L,   <span class="dv">10</span>L</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s reproduce the two plots using the datapoints.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-width: 10</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-height: 4</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r4pde)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>p_latent <span class="ot">&lt;-</span> latent <span class="sc">|&gt;</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(T, days))<span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>()</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>latent_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">T =</span> latent<span class="sc">$</span>T,  <span class="co"># Scale temperature</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="dv">1</span><span class="sc">/</span>latent<span class="sc">$</span>days<span class="sc">/</span><span class="dv">24</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>p_latent_rate <span class="ot">&lt;-</span> latent_rate <span class="sc">|&gt;</span> </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(T, R))<span class="sc">+</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>()</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>p_latent <span class="sc">|</span> p_latent_rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We will fit the parabolic function proposed by <span class="citation" data-cites="bernard2013">Bernard et al. (<a href="references.html#ref-bernard2013" role="doc-biblioref">2013</a>)</span> which predicts a thermal response curve (developmental rate, R), which is the relationship between the inverse of latent period and temperature. We need to enter the values for optimum temperature (where latent period is shortest) and the minimum latent period. The model is given by:</p>
<p><span class="math inline">\(R(T) = \frac{k}{\text{LP}_{\text{min}} + \text{a} \times (T - T_{\text{opt}})^2}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary package</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(minpack.lm)</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the model formula</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># model_formula &lt;- R ~ (a + b * T)^(c * T)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>LPmin <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># minimum latent period</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>Topt <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="co"># Optimal temperature</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>model_formula2 <span class="ot">&lt;-</span> R <span class="sc">~</span> k <span class="sc">/</span> (LPmin <span class="sc">+</span> a <span class="sc">*</span> (T <span class="sc">-</span> Topt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial parameter estimates</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#start_values &lt;- list(a = 0.1, b = 0.01, c = 0.01)</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>start_values2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">#fit_rate &lt;- nlsLM(model_formula, data = latent_rate, start = start_values)</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>fit_rate2 <span class="ot">&lt;-</span> <span class="fu">nls</span>(model_formula2, <span class="at">data =</span> latent_rate, <span class="at">start =</span> start_values2)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary of the fit</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_rate2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: R ~ k/(LPmin + a * (T - Topt)^2)

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)    
a 0.060274   0.010705    5.63 3.76e-05 ***
k 0.039520   0.001464   26.99 9.05e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0006936 on 16 degrees of freedom

Number of iterations to convergence: 6 
Achieved convergence tolerance: 3.183e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fit_rate2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         a          k 
0.06027417 0.03952035 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> fit_rate2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">1</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> fit_rate2<span class="sc">$</span>m<span class="sc">$</span><span class="fu">getAllPars</span>()[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we reproduce the plot with the fitted data. Note that the curve is not the same shown in the paper because we used a different equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">29</span>, <span class="fl">0.1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#R &lt;- (a + b * T)^(c * T)</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> k <span class="sc">/</span> (LPmin <span class="sc">+</span> a <span class="sc">*</span> (T <span class="sc">-</span> Topt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(T, R)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">|&gt;</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(T, R)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> latent_rate, <span class="fu">aes</span>(T, R)) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Inverse of the latent period (hour -1)"</span>, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="field-data" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="field-data"><span class="header-section-number">20.3</span> Field data</h2>
<p>Although pathogen inoculum, host resistance and agronomic factors are sometimes considered in combination with weather in empirically derived models using field data <span class="citation" data-cites="shah2013 cao2015 mehra2017">(<a href="references.html#ref-cao2015" role="doc-biblioref">Cao et al. 2015</a>; <a href="references.html#ref-mehra2017" role="doc-biblioref">Mehra et al. 2017</a>; <a href="references.html#ref-shah2013" role="doc-biblioref">Shah et al. 2013</a>)</span>, with a few examples of models using non-weather factors <span class="citation" data-cites="mehra2016 paul2004">(<a href="references.html#ref-mehra2016" role="doc-biblioref">Mehra et al. 2016</a>; <a href="references.html#ref-paul2004" role="doc-biblioref">Paul and Munkvold 2004</a>)</span>, most of these data-driven models primarily rely on weather variables as predictors <span class="citation" data-cites="gonzález-domínguez2023">(<a href="references.html#ref-gonzález-domínguez2023" role="doc-biblioref">González-Domínguez et al. 2023</a>)</span>. This emphasis is due to the significant influence of weather on key processes in the disease cycle, including pathogen survival and dispersal, host infection, and pathogen reproduction <span class="citation" data-cites="dewolf2007">(<a href="references.html#ref-dewolf2007" role="doc-biblioref">De Wolf and Isard 2007</a>)</span>. As a result, a central task for plant epidemiologists is to identify and quantify the relationships between weather conditions and a measure of disease intensity <span class="citation" data-cites="shah2019 eljarroudi2017 pietravalle2003 coakley1988 delponte2006 shah2013 coakley1988a">(<a href="references.html#ref-coakley1988" role="doc-biblioref">Coakley et al. 1988</a>; <a href="references.html#ref-coakley1988a" role="doc-biblioref">Coakley 1988</a>; <a href="references.html#ref-delponte2006" role="doc-biblioref">Del Ponte et al. 2006</a>; <a href="references.html#ref-eljarroudi2017" role="doc-biblioref">El Jarroudi et al. 2017</a>; <a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-shah2013" role="doc-biblioref">Shah et al. 2013</a>, <a href="references.html#ref-shah2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>In modeling efforts, the disease variable can be represented either as a continuous measure (e.g., incidence or severity) or as categorical data, which may be binary (e.g., non-epidemic vs.&nbsp;epidemic) or multinomial (e.g., low, moderate, and high severity). This variability in response types informs the selection of suitable modeling techniques, ensuring that the model accurately captures the nature of the data and the relationships between weather variables and disease outcomes.</p>
<p>In this section, I will demonstrate several modeling approaches that can be applied when field data is available. These examples will cover a range of techniques, starting with variable construction, which involves transforming raw weather data into summary measures that can effectively represent conditions relevant to disease outcomes. Next, variable selection methods will be explored to identify the most influential predictors, ensuring that models are both accurate and interpretable. The focus will then shift to model fitting, showing how different models, such as linear and logistic regression, can be used to capture relationships between weather variables and disease endpoints. Finally, model evaluation will be addressed, emphasizing metrics like accuracy, sensitivity, and area under the curve (AUC), which are crucial for assessing the predictive performance and reliability of the models developed.</p>
<section id="variable-construction" class="level3" data-number="20.3.1">
<h3 data-number="20.3.1" class="anchored" data-anchor-id="variable-construction"><span class="header-section-number">20.3.1</span> Variable construction</h3>
<p>Variable construction, especially when weather-related variables are concerned, relies not only on data transformation methods but also on the knowledge of the system, such as understanding how the disease responds to specific weather conditions that are likely to occur at specific growth stages <span class="citation" data-cites="decól2024 dewolf2003">(<a href="references.html#ref-decól2024" role="doc-biblioref">De Cól et al. 2024</a>; <a href="references.html#ref-dewolf2003" role="doc-biblioref">De Wolf et al. 2003</a>)</span>. This approach ensures that the derived variables accurately reflect biologically relevant processes, like the influence of temperature, humidity, or rainfall on disease dynamics.</p>
<p>In addition, data mining techniques are employed to systematically explore time-series data and identify potential weather-disease relationships <span class="citation" data-cites="shah2019 pietravalle2003 coakley1988">(<a href="references.html#ref-coakley1988" role="doc-biblioref">Coakley et al. 1988</a>; <a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-shah2019" role="doc-biblioref">Shah et al. 2019</a>)</span>. These techniques involve creating lagged variables, moving averages, or window-based summaries that capture delayed or cumulative effects of weather on disease outcomes. By integrating system knowledge with data mining, researchers aim to construct variables that are both biologically meaningful and statistically robust, improving the chances of identifying predictors that enhance model accuracy and interpretability.</p>
<section id="window-pane" class="level4" data-number="20.3.1.1">
<h4 data-number="20.3.1.1" class="anchored" data-anchor-id="window-pane"><span class="header-section-number">20.3.1.1</span> Window-pane</h4>
<p>With regards to weather variable creation for data-mining purposes, window-pane analysis, first introduced in the mid-1980s <span class="citation" data-cites="coakley1985">(<a href="references.html#ref-coakley1985" role="doc-biblioref">Coakley 1985</a>)</span>, has been widely used in modeling studies in plant pathology <span class="citation" data-cites="pietravalle2003 kriss2010 calverojr1996 tebeest2008a gouache2015a coakley1988 dallalana2021 coakley1988a">(<a href="references.html#ref-calverojr1996" role="doc-biblioref">Calvero Jr et al. 1996</a>; <a href="references.html#ref-coakley1988" role="doc-biblioref">Coakley et al. 1988</a>; <a href="references.html#ref-coakley1988a" role="doc-biblioref">Coakley 1988</a>; <a href="references.html#ref-dallalana2021" role="doc-biblioref">Dalla Lana et al. 2021</a>; <a href="references.html#ref-gouache2015a" role="doc-biblioref">Gouache et al. 2015</a>; <a href="references.html#ref-kriss2010" role="doc-biblioref">Kriss et al. 2010</a>; <a href="references.html#ref-pietravalle2003" role="doc-biblioref">Pietravalle et al. 2003</a>; <a href="references.html#ref-tebeest2008a" role="doc-biblioref">Te Beest et al. 2008</a>)</span>. This method aids in identifying weather conditions that are most strongly associated with disease outcomes by segmenting a continuous time series (e.g.&nbsp;daily temperature, relative humidity, and rainfall), into discrete, fixed-length windows.</p>
<p>The analysis involves summarizing conditions within each window (e.g., mean, sum, count) and correlating these summaries with disease outcomes, which may be expressed as continuous measures (e.g., severity) or as categorical variables (e.g., low vs.&nbsp;high levels). This approach allows users to set specific start and end times, as well as window lengths, enabling the exploration of different temporal relationships between weather and disease. By sliding the start and end points along the series, multiple overlapping windows are generated, making it possible to identify the most informative variables for modeling. The selected optimal fixed-time and fixed-window-length variables derived from this analysis serve as predictors in model development, helping to improve the accuracy and relevance of disease forecasting models.</p>
<p>Let’s create a code in R to demonstrate how the windows are defined in an example where four fixed lengths are defined over a 28-day period. The lengths are 7, 21, 14 and 28 consecutive days. In this case, there are 46 variables. Here is how it is calculated:</p>
<ul>
<li><p>7-day windows: 22 variables = 28 - 7 + 1</p></li>
<li><p>14-day windows: 15 variables = 28 - 15 + 1</p></li>
<li><p>21-day windows: 8 variables = 28 - 21 + 1</p></li>
<li><p>28-day window: 1 variable</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define total days and window lengths</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>max_days <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>window_lengths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">28</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty data frame for all sliding windows</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>window_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Populate the data frame with start and end points for each window</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>var_id <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Variable ID for each window</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (length <span class="cf">in</span> <span class="fu">sort</span>(window_lengths)) {  <span class="co"># Sort window lengths from shortest to longest</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (start_day <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(max_days <span class="sc">-</span> length)) {</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    end_day <span class="ot">&lt;-</span> start_day <span class="sc">+</span> length</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    window_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>      window_data,</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">start =</span> start_day,</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> end_day,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">var_id =</span> var_id,</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">window_length =</span> length</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>    var_id <span class="ot">&lt;-</span> var_id <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Increment variable ID</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert window_length to a factor for correct ordering in the legend</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>window_data<span class="sc">$</span>window_length <span class="ot">&lt;-</span> <span class="fu">factor</span>(window_data<span class="sc">$</span>window_length, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(window_data<span class="sc">$</span>window_length)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>window_data <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">xend =</span> end, <span class="at">y =</span> var_id, <span class="at">yend =</span> var_id, <span class="at">color =</span> window_length)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Line segments for each window</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span>max_days, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_days)) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span>var_id) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Window-pane"</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Each variable over 28 days"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Variable ID"</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Window Length (days)"</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  r4pde<span class="sc">::</span><span class="fu">theme_r4pde</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction-disease-modeling_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-analytis1977" class="csl-entry" role="listitem">
Analytis, S. 1977. Über die Relation zwischen biologischer Entwicklung und Temperatur bei phytopathogenen Pilzen. Journal of Phytopathology 90:64–76. <a href="https://doi.org/10.1111/j.1439-0434.1977.tb02886.x">https://doi.org/10.1111/j.1439-0434.1977.tb02886.x</a>.
</div>
<div id="ref-bailey1999" class="csl-entry" role="listitem">
Bailey, J. E. 1999. Integrated Method of Organizing, Computing, and Deploying Weather-Based Disease Advisories for Selected Peanut Disease. Peanut Science 26:74–80. <a href="https://doi.org/10.3146/i0095-3679-26-2-3">https://doi.org/10.3146/i0095-3679-26-2-3</a>.
</div>
<div id="ref-bernard2013" class="csl-entry" role="listitem">
Bernard, F., Sache, I., Suffert, F., and Chelle, M. 2013. The development of a foliar fungal pathogen does react to leaf temperature! New Phytologist 198:232–240. <a href="https://doi.org/10.1111/nph.12134">https://doi.org/10.1111/nph.12134</a>.
</div>
<div id="ref-bulger1987" class="csl-entry" role="listitem">
Bulger, M. A. 1987. Influence of temperature and wetness duration on infection of strawberry flowers by<span><em>Botrytis cinerea</em></span>and disease incidence of fruit originating from infected flowers. Phytopathology 77:1225. <a href="https://doi.org/10.1094/phyto-77-1225">https://doi.org/10.1094/phyto-77-1225</a>.
</div>
<div id="ref-calverojr1996" class="csl-entry" role="listitem">
Calvero Jr, S. B., Coakley, S. M., and Teng, P. S. 1996. <span><strong>Development of empirical forecasting models for rice blast based on weather factors</strong></span>. Plant Pathology 45:667–678. <a href="https://doi.org/10.1046/j.1365-3059.1996.d01-168.x">https://doi.org/10.1046/j.1365-3059.1996.d01-168.x</a>.
</div>
<div id="ref-cao2015" class="csl-entry" role="listitem">
Cao, X., Yao, D., Xu, X., Zhou, Y., Ding, K., Duan, X., Fan, J., and Luo, Y. 2015. Development of Weather- and Airborne Inoculum-Based Models to Describe Disease Severity of Wheat Powdery Mildew. Plant Disease 99:395–400. <a href="https://doi.org/10.1094/pdis-02-14-0201-re">https://doi.org/10.1094/pdis-02-14-0201-re</a>.
</div>
<div id="ref-coakley1985" class="csl-entry" role="listitem">
Coakley, S. M. 1985. Model for predicting severity of septoria tritici blotch on winter wheat. Phytopathology 75:1245. <a href="https://doi.org/10.1094/phyto-75-1245">https://doi.org/10.1094/phyto-75-1245</a>.
</div>
<div id="ref-coakley1988a" class="csl-entry" role="listitem">
Coakley, S. M. 1988. Predicting stripe rust severity on winter wheat using an improved method for analyzing meteorological and rust data. Phytopathology 78:543. <a href="https://doi.org/10.1094/phyto-78-543">https://doi.org/10.1094/phyto-78-543</a>.
</div>
<div id="ref-coakley1988" class="csl-entry" role="listitem">
Coakley, S. M., McDaniel, L. R., and Line, R. F. 1988. Quantifying how climatic factors affect variation in plant disease severity: A general method using a new way to analyze meteorological data. Climatic Change 12:57–75. <a href="https://doi.org/10.1007/bf00140264">https://doi.org/10.1007/bf00140264</a>.
</div>
<div id="ref-dallalana2021" class="csl-entry" role="listitem">
Dalla Lana, F., Madden, L. V., and Paul, P. A. 2021. Natural Occurrence of Maize Gibberella Ear Rot and Contamination of Grain with Mycotoxins in Association with Weather Variables. Plant Disease 105:114–126. <a href="https://doi.org/10.1094/pdis-05-20-0952-re">https://doi.org/10.1094/pdis-05-20-0952-re</a>.
</div>
<div id="ref-dallapria2006" class="csl-entry" role="listitem">
Dalla Pria, M., Christiano, R. C. S., Furtado, E. L., Amorim, L., and Bergamin Filho, A. 2006. Effect of temperature and leaf wetness duration on infection of sweet oranges by Asiatic citrus canker. Plant Pathology 55:657–663. <a href="https://doi.org/10.1111/j.1365-3059.2006.01393.x">https://doi.org/10.1111/j.1365-3059.2006.01393.x</a>.
</div>
<div id="ref-decól2024" class="csl-entry" role="listitem">
De Cól, M., Coelho, M., and Del Ponte, E. M. 2024. Weather-Based Logistic Regression Models for Predicting Wheat Head Blast Epidemics. Plant Disease 108:2206–2213. <a href="https://doi.org/10.1094/pdis-11-23-2513-re">https://doi.org/10.1094/pdis-11-23-2513-re</a>.
</div>
<div id="ref-dewolf2007" class="csl-entry" role="listitem">
De Wolf, E. D., and Isard, S. A. 2007. Disease Cycle Approach to Plant Disease Prediction. Annual Review of Phytopathology 45:203–220. <a href="https://doi.org/10.1146/annurev.phyto.44.070505.143329">https://doi.org/10.1146/annurev.phyto.44.070505.143329</a>.
</div>
<div id="ref-dewolf2003" class="csl-entry" role="listitem">
De Wolf, E. D., Madden, L. V., and Lipps, P. E. 2003. Risk Assessment Models for Wheat Fusarium Head Blight Epidemics Based on Within-Season Weather Data. Phytopathology® 93:428–435. <a href="https://doi.org/10.1094/phyto.2003.93.4.428">https://doi.org/10.1094/phyto.2003.93.4.428</a>.
</div>
<div id="ref-delponte2006" class="csl-entry" role="listitem">
Del Ponte, E. M., Godoy, C. V., Li, X., and Yang, X. B. 2006. Predicting Severity of Asian Soybean Rust Epidemics with Empirical Rainfall Models. Phytopathology® 96:797–803. <a href="https://doi.org/10.1094/phyto-96-0797">https://doi.org/10.1094/phyto-96-0797</a>.
</div>
<div id="ref-duthie1997" class="csl-entry" role="listitem">
Duthie, J. A. 1997. Models of the Response of Foliar Parasites to the Combined Effects of Temperature and Duration of Wetness. Phytopathology® 87:1088–1095. <a href="https://doi.org/10.1094/phyto.1997.87.11.1088">https://doi.org/10.1094/phyto.1997.87.11.1088</a>.
</div>
<div id="ref-eljarroudi2017" class="csl-entry" role="listitem">
El Jarroudi, M., Kouadio, L., Bock, C. H., El Jarroudi, M., Junk, J., Pasquali, M., Maraite, H., and Delfosse, P. 2017. A Threshold-Based Weather Model for Predicting Stripe Rust Infection in Winter Wheat. Plant Disease 101:693–703. <a href="https://doi.org/10.1094/pdis-12-16-1766-re">https://doi.org/10.1094/pdis-12-16-1766-re</a>.
</div>
<div id="ref-evans1992" class="csl-entry" role="listitem">
Evans, K. J. 1992. A model based on temperature and leaf wetness duration for establishment of alternaria leaf blight of muskmelon. Phytopathology 82:890. <a href="https://doi.org/10.1094/phyto-82-890">https://doi.org/10.1094/phyto-82-890</a>.
</div>
<div id="ref-fedele2022a" class="csl-entry" role="listitem">
Fedele, G., Brischetto, C., Rossi, V., and Gonzalez-Dominguez, E. 2022. A Systematic Map of the Research on Disease Modelling for Agricultural Crops Worldwide. Plants 11:724. <a href="https://doi.org/10.3390/plants11060724">https://doi.org/10.3390/plants11060724</a>.
</div>
<div id="ref-gonzález-domínguez2023" class="csl-entry" role="listitem">
González-Domínguez, E., Caffi, T., Rossi, V., Salotti, I., and Fedele, G. 2023. Plant Disease Models and Forecasting: Changes in Principles and Applications over the Last 50 Years. Phytopathology® 113:678–693. <a href="https://doi.org/10.1094/phyto-10-22-0362-kd">https://doi.org/10.1094/phyto-10-22-0362-kd</a>.
</div>
<div id="ref-gouache2015a" class="csl-entry" role="listitem">
Gouache, D., Léon, M. S., Duyme, F., and Braun, P. 2015. A novel solution to the variable selection problem in Window Pane approaches of plant pathogen <span></span> Climate models: Development, evaluation and application of a climatological model for brown rust of wheat. Agricultural and Forest Meteorology 205:51–59. <a href="https://doi.org/10.1016/j.agrformet.2015.02.013">https://doi.org/10.1016/j.agrformet.2015.02.013</a>.
</div>
<div id="ref-hau1990" class="csl-entry" role="listitem">
Hau, B., and Kranz, J. 1990. Mathematics and statistics for analyses in epidemiology. In Springer Berlin Heidelberg, pp. 12–52. <a href="https://doi.org/10.1007/978-3-642-75398-5_2">https://doi.org/10.1007/978-3-642-75398-5_2</a>.
</div>
<div id="ref-ji2021" class="csl-entry" role="listitem">
Ji, T., Languasco, L., Li, M., and Rossi, V. 2021. Effects of Temperature and Wetness Duration on Infection by Coniella diplodiella, the Fungus Causing White Rot of Grape Berries. Plants 10:1696. <a href="https://doi.org/10.3390/plants10081696">https://doi.org/10.3390/plants10081696</a>.
</div>
<div id="ref-ji2023a" class="csl-entry" role="listitem">
Ji, T., Salotti, I., Altieri, V., Li, M., and Rossi, V. 2023. Temperature-Dependent Growth and Spore Germination of Fungi Causing Grapevine Trunk Diseases: Quantitative Analysis of Literature Data. Plant Disease 107:1386–1398. <a href="https://doi.org/10.1094/pdis-09-22-2249-re">https://doi.org/10.1094/pdis-09-22-2249-re</a>.
</div>
<div id="ref-krause1975" class="csl-entry" role="listitem">
Krause, R. A., and Massie, L. B. 1975. Predictive Systems: Modern Approaches to Disease Control. Annual Review of Phytopathology 13:31–47. <a href="https://doi.org/10.1146/annurev.py.13.090175.000335">https://doi.org/10.1146/annurev.py.13.090175.000335</a>.
</div>
<div id="ref-kriss2010" class="csl-entry" role="listitem">
Kriss, A. B., Paul, P. A., and Madden, L. V. 2010. Relationship Between Yearly Fluctuations in Fusarium Head Blight Intensity and Environmental Variables: A Window-Pane Analysis. Phytopathology® 100:784–797. <a href="https://doi.org/10.1094/phyto-100-8-0784">https://doi.org/10.1094/phyto-100-8-0784</a>.
</div>
<div id="ref-lannou2012" class="csl-entry" role="listitem">
Lannou, C. 2012. Variation and Selection of Quantitative Traits in Plant Pathogens. Annual Review of Phytopathology 50:319–338. <a href="https://doi.org/10.1146/annurev-phyto-081211-173031">https://doi.org/10.1146/annurev-phyto-081211-173031</a>.
</div>
<div id="ref-machardy1989" class="csl-entry" role="listitem">
MacHardy, W. E. 1989. A revision of mills’s criteria for predicting apple scab infection periods. Phytopathology 79:304. <a href="https://doi.org/10.1094/phyto-79-304">https://doi.org/10.1094/phyto-79-304</a>.
</div>
<div id="ref-madden2007" class="csl-entry" role="listitem">
Madden, L. V., Hughes, G., and van den Bosch, F. 2007. <em>The study of plant disease epidemics</em>. The American Phytopathological Society. <a href="https://doi.org/10.1094/9780890545058">https://doi.org/10.1094/9780890545058</a>.
</div>
<div id="ref-magarey2007" class="csl-entry" role="listitem">
Magarey, R. D., and Sutton, T. B. 2007. How to Create and Deploy Infection Models for Plant Pathogens. In Springer Netherlands, pp. 3–25. <a href="https://doi.org/10.1007/978-1-4020-6061-8_1">https://doi.org/10.1007/978-1-4020-6061-8_1</a>.
</div>
<div id="ref-magarey2005" class="csl-entry" role="listitem">
Magarey, R. D., Sutton, T. B., and Thayer, C. L. 2005. A Simple Generic Infection Model for Foliar Fungal Plant Pathogens. Phytopathology® 95:92–100. <a href="https://doi.org/10.1094/phyto-95-0092">https://doi.org/10.1094/phyto-95-0092</a>.
</div>
<div id="ref-magarey2002" class="csl-entry" role="listitem">
Magarey, R. D., Travis, J. W., Russo, J. M., Seem, R. C., and Magarey, P. A. 2002. Decision Support Systems: Quenching the Thirst. Plant Disease 86:4–14. <a href="https://doi.org/10.1094/pdis.2002.86.1.4">https://doi.org/10.1094/pdis.2002.86.1.4</a>.
</div>
<div id="ref-mehra2016" class="csl-entry" role="listitem">
Mehra, L. K., Cowger, C., Gross, K., and Ojiambo, P. S. 2016. Predicting pre-planting risk of stagonospora nodorum blotch in winter wheat using machine learning models. Frontiers in Plant Science 7. <a href="https://doi.org/10.3389/fpls.2016.00390">https://doi.org/10.3389/fpls.2016.00390</a>.
</div>
<div id="ref-mehra2017" class="csl-entry" role="listitem">
Mehra, L. K., Cowger, C., and Ojiambo, P. S. 2017. A Model for Predicting Onset of Stagonospora nodorum Blotch in Winter Wheat Based on Preplanting and Weather Factors. Phytopathology® 107:635–644. <a href="https://doi.org/10.1094/phyto-03-16-0133-r">https://doi.org/10.1094/phyto-03-16-0133-r</a>.
</div>
<div id="ref-mills1944" class="csl-entry" role="listitem">
Mills, W. D. 1944. Efficient use of sulfur dusts and sprays during rain to control apple scab. Cornell Extension Bulletin 630.
</div>
<div id="ref-paul2004" class="csl-entry" role="listitem">
Paul, P. A., and Munkvold, G. P. 2004. A Model-Based Approach to Preplanting Risk Assessment for Gray Leaf Spot of Maize. Phytopathology® 94:1350–1357. <a href="https://doi.org/10.1094/phyto.2004.94.12.1350">https://doi.org/10.1094/phyto.2004.94.12.1350</a>.
</div>
<div id="ref-pfender2003" class="csl-entry" role="listitem">
Pfender, W. F. 2003. Prediction of Stem Rust Infection Favorability, by Means of Degree-Hour Wetness Duration, for Perennial Ryegrass Seed Crops. Phytopathology® 93:467–477. <a href="https://doi.org/10.1094/phyto.2003.93.4.467">https://doi.org/10.1094/phyto.2003.93.4.467</a>.
</div>
<div id="ref-pietravalle2003" class="csl-entry" role="listitem">
Pietravalle, S., Shaw, M. W., Parker, S. R., and Bosch, F. van den. 2003. Modeling of Relationships Between Weather and <span><em>Septoria tritici</em></span> Epidemics on Winter Wheat: A Critical Approach. Phytopathology® 93:1329–1339. <a href="https://doi.org/10.1094/phyto.2003.93.10.1329">https://doi.org/10.1094/phyto.2003.93.10.1329</a>.
</div>
<div id="ref-rossi2008" class="csl-entry" role="listitem">
Rossi, V., Caffi, T., Giosuè, S., and Bugiani, R. 2008. A mechanistic model simulating primary infections of downy mildew in grapevine. Ecological Modelling 212:480–491. <a href="https://doi.org/10.1016/j.ecolmodel.2007.10.046">https://doi.org/10.1016/j.ecolmodel.2007.10.046</a>.
</div>
<div id="ref-rossi2010a" class="csl-entry" role="listitem">
Rossi, V., Giosuè, S., and Caffi, T. 2010. Modelling Plant Diseases for Decision Making in Crop Protection. In Springer Netherlands, pp. 241–258. <a href="https://doi.org/10.1007/978-90-481-9277-9_15">https://doi.org/10.1007/978-90-481-9277-9_15</a>.
</div>
<div id="ref-rossi2014" class="csl-entry" role="listitem">
Rossi, V., Onesti, G., Legler, S. E., and Caffi, T. 2014. Use of systems analysis to develop plant disease models based on literature data: grape black-rot as a case-study. European Journal of Plant Pathology 141:427–444. <a href="https://doi.org/10.1007/s10658-014-0553-z">https://doi.org/10.1007/s10658-014-0553-z</a>.
</div>
<div id="ref-rotem1988" class="csl-entry" role="listitem">
Rotem, J. 1988. Techniques of Controlled-Condition Experiments. In Springer Berlin Heidelberg, pp. 19–31. <a href="https://doi.org/10.1007/978-3-642-95534-1_3">https://doi.org/10.1007/978-3-642-95534-1_3</a>.
</div>
<div id="ref-salotti2022" class="csl-entry" role="listitem">
Salotti, I., Bove, F., and Rossi, V. 2022. Development and validation of a mechanistic, weather-based model for predicting puccinia graminis f. Sp. Tritici infections and stem rust progress in wheat. Frontiers in Plant Science 13. <a href="https://doi.org/10.3389/fpls.2022.897680">https://doi.org/10.3389/fpls.2022.897680</a>.
</div>
<div id="ref-salotti2023" class="csl-entry" role="listitem">
Salotti, I., and Rossi, V. 2023. A Mechanistic Model Accounting for the Effect of Soil Moisture, Weather, and Host Growth Stage on the Development of <span><em>Sclerotinia sclerotiorum</em></span>. Plant Disease 107:514–533. <a href="https://doi.org/10.1094/pdis-12-21-2743-re">https://doi.org/10.1094/pdis-12-21-2743-re</a>.
</div>
<div id="ref-savary2018" class="csl-entry" role="listitem">
Savary, S., Nelson, A. D., Djurle, A., Esker, P. D., Sparks, A., Amorim, L., Bergamin Filho, A., Caffi, T., Castilla, N., Garrett, K., McRoberts, N., Rossi, V., Yuen, J., and Willocquet, L. 2018. Concepts, approaches, and avenues for modelling crop health and crop losses. European Journal of Agronomy 100:4–18. <a href="https://doi.org/10.1016/j.eja.2018.04.003">https://doi.org/10.1016/j.eja.2018.04.003</a>.
</div>
<div id="ref-seem1984" class="csl-entry" role="listitem">
Seem, R. C. 1984. Simple decision aids for practical control of pests. Plant Disease 68:656. <a href="https://doi.org/10.1094/pd-69-656">https://doi.org/10.1094/pd-69-656</a>.
</div>
<div id="ref-shah2013" class="csl-entry" role="listitem">
Shah, D. A., Molineros, J. E., Paul, P. A., Willyerd, K. T., Madden, L. V., and De Wolf, E. D. 2013. Predicting Fusarium Head Blight Epidemics With Weather-Driven Pre- and Post-Anthesis Logistic Regression Models. Phytopathology® 103:906–919. <a href="https://doi.org/10.1094/phyto-11-12-0304-r">https://doi.org/10.1094/phyto-11-12-0304-r</a>.
</div>
<div id="ref-shah2019" class="csl-entry" role="listitem">
Shah, D. A., Paul, P. A., De Wolf, E. D., and Madden, L. V. 2019. Predicting plant disease epidemics from functionally represented weather series. Philosophical Transactions of the Royal Society B: Biological Sciences 374:20180273. <a href="https://doi.org/10.1098/rstb.2018.0273">https://doi.org/10.1098/rstb.2018.0273</a>.
</div>
<div id="ref-tebeest2008a" class="csl-entry" role="listitem">
Te Beest, D. E., Paveley, N. D., Shaw, M. W., and Bosch, F. van den. 2008. Disease<span></span>Weather Relationships for Powdery Mildew and Yellow Rust on Winter Wheat. Phytopathology® 98:609–617. <a href="https://doi.org/10.1094/phyto-98-5-0609">https://doi.org/10.1094/phyto-98-5-0609</a>.
</div>
<div id="ref-plantdi1963" class="csl-entry" role="listitem">
Vanderplank, J. 1963. <em>Plant disease epidemics and control</em>. Elsevier. <a href="https://doi.org/10.1016/c2013-0-11642-x">https://doi.org/10.1016/c2013-0-11642-x</a>.
</div>
<div id="ref-windels1998" class="csl-entry" role="listitem">
Windels, C. E., Lamey, H. A., Hilde, D., Widner, J., and Knudsen, T. 1998. A Cerospora Leaf Spot Model for Sugar Beet: In Practice by an Industry. Plant Disease 82:716–726. <a href="https://doi.org/10.1094/pdis.1998.82.7.716">https://doi.org/10.1094/pdis.1998.82.7.716</a>.
</div>
<div id="ref-xu2000" class="csl-entry" role="listitem">
Xu, X.-M., and Robinson, J. D. 2000. Effects of temperature on the incubation and latent periods of hawthorn powdery mildew (<span><em>Podosphaera clandestina</em></span>). Plant Pathology 49:791–797. <a href="https://doi.org/10.1046/j.1365-3059.2000.00520.x">https://doi.org/10.1046/j.1365-3059.2000.00520.x</a>.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./prediction-warning-systems.html" class="pagination-link" aria-label="Warning systems">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Warning systems</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>R4PDE - R for Plant Disease Epidemiology is written by Emerson Del Ponte</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/emdelponte/epidemiology-R/edit/main/prediction-disease-modeling.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/emdelponte/epidemiology-R/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>